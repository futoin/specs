{
  "iface": "futoin.secvault.types",
  "version": "0.2",
  "ftn3rev": "1.8",
  "imports": [
    "futoin.types:1.0"
  ],
  "types": {
    "KeyID": "UUIDB64",
    "ExtID": {
      "type": "string",
      "minlen": 1,
      "maxlen": 128
    },
    "KeyType": {
      "type": "GenericIdentifier",
      "minlen": 1,
      "maxlen": 32
    },
    "KeyUsage": {
      "type": "set",
      "items": [
        "encrypt",
        "sign",
        "derive",
        "shared",
        "temp"
      ]
    },
    "ContainerFormat": {
      "type": "GenericIdentifier",
      "minlen": 1,
      "maxlen": 32
    },
    "GenParams": [
      "string",
      "integer",
      "map"
    ],
    "KeyInfo": {
      "type": "map",
      "fields": {
        "id": "KeyID",
        "usage": "KeyUsage",
        "type": "KeyType",
        "params": "GenParams",
        "created": "Timestamp",
        "used_times": "NotNegativeInteger",
        "used_bytes": "NotNegativeInteger",
        "sig_failures": "NotNegativeInteger"
      }
    },
    "KeyInfoList": {
      "type": "array",
      "elemtype": "KeyInfo"
    },
    "PublicKey": {
      "type": "map",
      "fields": {
        "key_type": "KeyType",
        "format": "ContainerFormat",
        "data": "string"
      }
    },
    "CipherType": {
      "type": "string",
      "regex": "^[a-Z0-9][a-Z0-9-]*[a-Z0-9]$",
      "maxlen": 64
    },
    "KeyDerivationFunction": "CipherType"
  },
  "requires": [
    "SecureChannel"
  ]
}