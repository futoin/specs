{
  "iface": "futoin.auth.types",
  "version": "0.2",
  "ftn3rev": "1.8",
  "imports": [
    "futoin.types:1.0"
  ],
  "types": {
    "LocalUserID": "UUIDB64",
    "LocalUser": {
      "type": "string",
      "regex": "^[a-zA-Z]([a-zA-Z0-9_.-]{0,30}[a-zA-Z0-9])?$"
    },
    "GlobalService": "Domain",
    "GlobalUserID": [
      "Email",
      "GlobalService"
    ],
    "MACAlgo": {
      "type": "enum",
      "items": [
        "HMAC-MD5",
        "HMAC-SHA-224",
        "HMAC-SHA-256",
        "HMAC-SHA-384",
        "HMAC-SHA-512",
        "HMAC-SHA3-224",
        "HMAC-SHA3-256",
        "HMAC-SHA3-384",
        "HMAC-SHA3-512",
        "KMAC128",
        "KMAC256"
      ]
    },
    "StatelessSecret": {
      "type": "string",
      "minlen": 8,
      "maxlen": 32
    },
    "MACValue": {
      "type": "Base64",
      "minlen": 1,
      "maxlen": 128
    },
    "MACBase": {
      "type": "string",
      "minlen": 8
    },
    "MasterSecretID": "UUIDB64",
    "MasterScope": "Domain",
    "KeyDerivationStrategy": {
      "type": "enum",
      "items": [
        "HKDF",
        "HKDF0"
      ]
    },
    "KeyPurpose": {
      "type": "enum",
      "items": [
        "MAC",
        "ENC",
        "EXPOSED"
      ]
    },
    "PublicKeyType": {
      "type": "enum",
      "items": [
        "RSA-2048",
        "RSA-4096",
        "ED25519"
      ]
    },
    "PublicKey": {
      "type": "Base64",
      "minlen": 1
    },
    "EncryptedKey": {
      "type": "Base64",
      "minlen": 1,
      "maxlen": 683
    },
    "EncryptedMasterSecret": "EncryptedKey",
    "UserAgent": {
      "type": "string",
      "maxlen": 256
    },
    "X509Cert": {
      "type": "Base64",
      "maxlen": 16384
    },
    "SSHPubKey": {
      "type": "string",
      "maxlen": 8192
    },
    "ClientToken": {
      "type": "Base64",
      "maxlen": 342,
      "desc": "Unique per Service per Client device persistent token"
    },
    "ClientFingerprints": {
      "type": "map",
      "fields": {
        "user_agent": {
          "type": "UserAgent",
          "optional": true
        },
        "source_ip": {
          "type": "IPAddress",
          "optional": true
        },
        "x509": {
          "type": "X509Cert",
          "optional": true
        },
        "ssh_pubkey": {
          "type": "SSHPubKey",
          "optional": true
        },
        "client_token": {
          "type": "ClientToken",
          "optional": true
        },
        "misc": {
          "type": "map",
          "optional": true
        }
      }
    },
    "AuthInfo": {
      "type": "map",
      "fields": {
        "local_id": "LocalUserID",
        "global_id": "GlobalUserID"
      }
    },
    "RedirectURL": {
      "type": "string",
      "regex": "^https?://[a-z0-9-]+(\\.[a-z0-9-]+)*\\.[a-z]{2,}/[a-Z0-9_/-]*(\\?[a-Z][a-Z0-9]*=)?$",
      "maxlen": 128
    },
    "ResourceURL": {
      "type": "string",
      "regex": "^https?://[a-z0-9-]+(\\.[a-z0-9-]+)*\\.[a-z]{2,}/[a-Z0-9_/?=%&;.-]*$",
      "maxlen": 128
    },
    "ParamConstraint": {
      "type": "map",
      "elemtype": "array"
    },
    "AccessControlDescriptor": {
      "type": "map",
      "fields": {
        "iface": {
          "type": "FTNFace",
          "optional": true
        },
        "ver": {
          "type": "FTNVersion",
          "optional": true
        },
        "func": {
          "type": "FTNFunction",
          "optional": true
        },
        "params": {
          "type": "ParamConstraint",
          "optional": true,
          "desc": "Named paramater must match one of the values"
        }
      },
      "desc": "Granted API access constraints in scope of arbitrary Service"
    },
    "AccessControlDescriptorList": {
      "type": "array",
      "elemtype": "AccessControlDescriptor",
      "desc": "List of granted API access in scope of arbitrary Service"
    },
    "AccessGroupName": {
      "type": "GenericIdentifier",
      "maxlen": 32,
      "desc": "Service-specific arbitrary ACD grouping identifier"
    },
    "AccessGroup": {
      "type": "map",
      "fields": {
        "id": "AccessGroupName",
        "name": "ItemTranslations",
        "desc": "ItemTranslations",
        "acds": "AccessControlDescriptorList",
        "icon": "ResourceURL"
      },
      "desc": "Services-specific arbitrary ACD grouping definition"
    },
    "AccessGroupList": {
      "type": "array",
      "elemtype": "ServiceAccessGroup",
      "desc": "List of Service-specific ACD groupings"
    },
    "ServiceAccessGroup": {
      "type": "map",
      "fields": {
        "service": "GlobalService",
        "access_group": "AccessGroupName"
      },
      "desc": "Global pointer to ACD group of specific Service"
    },
    "ServiceAccessGroupList": {
      "type": "array",
      "elemtype": "ServiceAccessGroup",
      "desc": "List of global pointers to Service-specific ACD groups"
    }
  }
}