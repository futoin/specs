{
  "iface": "futoin.auth.types",
  "version": "0.2",
  "ftn3rev": "1.8",
  "imports": [
    "futoin.types:1.0"
  ],
  "types": {
    "FTNRequest": {
      "type": "map",
      "fields": {
        "f": "string",
        "p": "map",
        "rid": {
          "type": "string",
          "optional": true
        },
        "sec": {
          "type": "any",
          "optional": true
        },
        "obf": {
          "type": "any",
          "optional": true
        }
      }
    },
    "FTNResponse": {
      "type": "map",
      "fields": {
        "r": "any",
        "rid": {
          "type": "string",
          "optional": true
        },
        "sec": {
          "type": "any",
          "optional": true
        }
      }
    },
    "LocalUserID": "UUIDB64",
    "LocalUser": {
      "type": "string",
      "regex": "^[a-zA-Z]([a-zA-Z0-9_.-]{0,30}[a-zA-Z0-9])?$"
    },
    "GlobalUserID": "Email",
    "ClearSecret": {
      "type": "string",
      "minlen": 8,
      "maxlen": 32
    },
    "MACAlgo": {
      "type": "enum",
      "items": [
        "HMAC-MD5",
        "HMAC-SHA-224",
        "HMAC-SHA-256",
        "HMAC-SHA-384",
        "HMAC-SHA-512",
        "HMAC-SHA3-224",
        "HMAC-SHA3-256",
        "HMAC-SHA3-384",
        "HMAC-SHA3-512",
        "KMAC128",
        "KMAC256"
      ]
    },
    "MACSecret": {
      "type": "Base64",
      "minlen": 32,
      "maxlen": 128
    },
    "MACValue": {
      "type": "Base64",
      "minlen": 1,
      "maxlen": 128
    },
    "MACBase": {
      "type": "string",
      "minlen": 8
    },
    "MasterKeyID": "UUIDB64",
    "KeyDerivationStrategy": {
      "type": "enum",
      "items": [
        "HKDF",
        "HKDF0"
      ]
    },
    "KeyPurpose": {
      "type": "enum",
      "items": [
        "MAC",
        "ENC",
        "EXPOSED"
      ]
    },
    "RequestSource": {
      "type": "map",
      "fields": {
        "ip": {
          "type": "IPAddress",
          "optional": true
        },
        "x509_cn": {
          "type": "string",
          "optional": true
        }
      }
    },
    "PublicKeyType": {
      "type": "enum",
      "items": [
        "RSA-2048",
        "RSA-4096",
        "ED25519"
      ]
    },
    "PublicKey": {
      "type": "Base64",
      "minlen": 1
    },
    "EncryptedMasterKey": {
      "type": "Base64",
      "minlen": 1
    }
  }
}