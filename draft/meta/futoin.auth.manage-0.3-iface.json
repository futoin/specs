{
  "iface": "futoin.auth.manage",
  "version": "0.3",
  "ftn3rev": "1.8",
  "imports": [
    "futoin.ping:1.0",
    "futoin.auth.types:0.3"
  ],
  "funcs": {
    "setup": {
      "params": {
        "domain": "Domain",
        "clear_auth": {
          "type": "boolean",
          "default": false
        },
        "mac_auth": {
          "type": "boolean",
          "default": true
        },
        "master_auth": {
          "type": "boolean",
          "default": true
        },
        "master_auto_reg": {
          "type": "boolean",
          "default": false
        },
        "auth_service": {
          "type": "boolean",
          "default": false
        }
      },
      "result": "boolean"
    },
    "genConfig": {
      "result": {
        "domain": "Domain",
        "clear_auth": "boolean",
        "mac_auth": "boolean",
        "master_auth": "boolean",
        "master_auto_reg": "boolean"
      }
    },
    "ensureUser": {
      "params": {
        "user": "LocalUser",
        "global_id": {
          "type": "GlobalUserID",
          "default": null,
          "desc": "Defaults to auto-generated"
        },
        "hostname": {
          "type": "Domain",
          "default": null,
          "desc": "Required for Service users"
        }
      },
      "result": "LocalUserID",
      "throws": [
        "GlobalUserIDMismatch"
      ]
    },
    "ensureService": {
      "params": {
        "hostname": {
          "type": "GlobalService",
          "default": null,
          "desc": "Act as both local and global user name"
        }
      },
      "result": "LocalUserID"
    }
  },
  "requires": [
    "SecureChannel",
    "MessageSignature"
  ]
}